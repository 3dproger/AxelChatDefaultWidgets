(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{49:function(e){e.exports={name:"axelchat-react",version:"0.5.0",private:!0,homepage:".",dependencies:{"@emotion/react":"^11.10.6","@emotion/styled":"^11.10.6","@mui/material":"^5.11.10","@testing-library/jest-dom":"^5.16.5","@testing-library/react":"^13.4.0","@testing-library/user-event":"^13.5.0",antd:"^5.6.1",react:"^18.2.0","react-dom":"^18.2.0","react-router-dom":"^6.8.1","react-scripts":"^2.1.8","react-use-websocket":"^4.2.0","web-vitals":"^2.1.4"},scripts:{start:"react-scripts --openssl-legacy-provider start",build:"react-scripts --openssl-legacy-provider build",test:"react-scripts --openssl-legacy-provider test",eject:"react-scripts --openssl-legacy-provider eject"},eslintConfig:{extends:["react-app","react-app/jest"]},browserslist:{production:[">0.2%","not dead","not op_mini all"],development:["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}},52:function(e,t,a){},68:function(e,t,a){e.exports=a(86)},86:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(56),c=a.n(s),i=(a(52),a(1)),o=a(10),l=a(2),u=a(18),m=a.n(u),p=a(38),d=a(9),f=a(11),v=a(13),g=a(8),b=a(12),h=a(91),E=a(92),y="Image",O="Spin",j=function(e){function t(){return Object(d.a)(this,t),Object(v.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return this.props.type===O?r.a.createElement("span",null,r.a.createElement(h.a,{style:{marginRight:"4px"},indicator:r.a.createElement(E.a,{style:{fontSize:24},spin:!0})}),r.a.createElement("span",{className:"authorName"},this.props.text)):r.a.createElement("span",null,r.a.createElement("img",{className:"badgeServiceIcon",alt:"",src:this.props.imageSrc}),r.a.createElement("span",{className:"authorName"},this.props.text))}}]),t}(r.a.Component);j.defaultProps={type:O,text:"TEXT",imageSrc:"./images/tick.svg"};var S=function(e){function t(){return Object(d.a)(this,t),Object(v.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props.content;if(!e)return r.a.createElement("div",null,"null");var t=e.type,a=e.data;if("text"===t){var n=a.text;return r.a.createElement("span",{className:"text"},n)}return"image"===t?r.a.createElement("img",{className:"imageContent",alt:"",src:a.url}):"hyperlink"===t?r.a.createElement("span",null," ",r.a.createElement("a",{className:"hyperlinkContent",href:a.url},r.a.createElement("span",null,a.text))," "):r.a.createElement("div",null,"Unknown content type '",t,"'")}}]),t}(r.a.Component);S.defaultProps={content:null};var N=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(v.a)(this,Object(g.a)(t).call(this,e))).state={needToHide:!1},e.hideTimeout>0&&setTimeout(function(){a.setState({needToHide:!0})},e.hideTimeout),a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props.message;if(!e)return r.a.createElement("div",null,"Message is null");var t=e.author;if(!t)return r.a.createElement("div",null,"Author is null");var a=e.forcedColors;return r.a.createElement("span",{className:"message"+(this.state.needToHide?" hiddenFadeOut":""),style:{backgroundColor:a.bodyBackground,visibility:this.state.visibility}},r.a.createElement("span",{className:"badges"},r.a.createElement("img",{className:"badgeServiceIcon",alt:"badge service icon",src:"./images/"+t.serviceId+"-icon.svg"}),t.leftBadges.map(function(e,t){return r.a.createElement("img",{key:t,className:"badgeLeft",alt:"",src:e})})),r.a.createElement("span",{className:"authorName"+(t.customBackgroundColor.length>0?" authorNameCustomBackgroundColor":""),style:{color:t.color,backgroundColor:t.customBackgroundColor}},t.name),t.rightBadges.map(function(e,t){return r.a.createElement("img",{key:t,className:"badgeRight",alt:"",src:e})}),r.a.createElement("span",{className:"authorMessageContentSeparator"}),r.a.createElement("span",{className:"messageContents"},e.contents.map(function(e,t){return r.a.createElement(S,{key:t,content:e})})))}}]),t}(r.a.Component);N.defaultProps={message:null,hideTimeout:0};var C=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(v.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).scrollToBottom=function(){void 0!==a.messagesEnd&&null!==a.messagesEnd&&a.messagesEnd.scrollIntoView({behavior:"smooth"})},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"render",value:function(){var e=this;return 0===this.props.messages.length?r.a.createElement(j,{type:y,text:"Connected!",imageSrc:"./images/tick.svg"}):r.a.createElement("div",{className:"messagesListView"},this.props.messages.map(function(t){return r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"},key:t.id},r.a.createElement(N,{message:t,hideTimeout:e.props.hideTimeout}))}),r.a.createElement("div",{style:{float:"left",clear:"both"},ref:function(t){e.messagesEnd=t}}))}}]),t}(r.a.Component);C.defaultProps={messages:[],hideTimeout:0};var w=function(e){function t(){return Object(d.a)(this,t),Object(v.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props.service;return e?e.enabled?r.a.createElement("span",{className:"serviceIndicator"},r.a.createElement("img",{className:"badgeServiceIcon",alt:e.type_id,src:"./images/"+e.type_id+"-icon.svg"}),r.a.createElement("span",{className:"text"},-1!==e.viewers?e.viewers.toLocaleString():"")):r.a.createElement("span",null):r.a.createElement("div",null,"null")}}]),t}(r.a.Component);w.defaultProps={service:null};var T=function(e){function t(){return Object(d.a)(this,t),Object(v.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,this.props.services.map(function(e,t){return r.a.createElement(w,{key:t,service:e})}),r.a.createElement("span",{className:"serviceIndicator"},r.a.createElement("img",{className:"badgeServiceIcon",alt:"viewers-count",src:"./images/person.svg"}),r.a.createElement("span",{className:"text"},this.props.appState.viewers>-1?this.props.appState.viewers.toLocaleString():"?")))}}]),t}(r.a.Component);T.defaultProps={services:[],appState:null};var k=a(49);function A(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"===typeof e)return I(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return I(e,t)}(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,c=!0,i=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return c=e.done,e},e:function(e){i=!0,s=e},f:function(){try{c||null==a.return||a.return()}finally{if(i)throw s}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var x=function(){var e,t=Object(p.b)(),a=Object(l.a)(t,1)[0],s=Object(n.useState)(new Map),c=Object(l.a)(s,1)[0],d=Object(n.useState)([]),f=Object(l.a)(d,2),v=f[0],g=f[1],b=Object(n.useState)(new Map),h=Object(l.a)(b,2),E=h[0],S=(h[1],Object(n.useState)([])),N=Object(l.a)(S,2),w=N[0],I=N[1],x=Object(n.useState)([]),L=Object(l.a)(x,2),R=L[0],M=L[1],_=Object(n.useState)({viewers:-1}),B=Object(l.a)(_,2),G=B[0],D=B[1],H=r.a.useState(),P=Object(l.a)(H,2)[1],U=r.a.useCallback(function(){return P({})},[]),J=m()("ws://localhost:8355",{onOpen:function(){g([]),V(JSON.stringify({type:"HELLO",data:{client:{type:"MAIN_WEBSOCKETCLIENT",name:k.name,version:k.version},info:{type:"WIDGET",name:a.get("widget")}}}))},shouldReconnect:function(e){return!0}}),V=J.sendMessage,W=J.lastMessage,z=J.readyState;Object(n.useEffect)(function(){if(W){var e=JSON.parse(W.data),t=e.type,a=e.data;if("NEW_MESSAGES_RECEIVED"===t)g(function(e){var t;e=(t=e).concat.apply(t,Object(o.a)(a.messages));var n,r=A(a.messages);try{for(r.s();!(n=r.n()).done;){var s=n.value;E.set(s.id,s);var i=s.author;c.set(i.id,i)}}catch(p){r.e(p)}finally{r.f()}if(e.length>70)for(var l=e.length-70,u=0;u<l;u++){var m=e.shift();E.delete(m.id)}return e});else if("STATES_CHANGED"===t)M(a.services),D(a);else if("MESSAGES_CHANGED"===t){var n,r=A(a.messages);try{for(r.s();!(n=r.n()).done;){var s=n.value,i=E.get(s.id);"undefined"!==typeof i&&null!==i&&Object.assign(i,s)}}catch(p){r.e(p)}finally{r.f()}U()}else if("MESSAGES_SELECTED"===t)I(function(e){var t,n=A(a.messages);try{for(n.s();!(t=n.n()).done;){var r=t.value.author;c.set(r.id,r)}}catch(p){n.e(p)}finally{n.f()}return a.messages});else if("AUTHOR_VALUES_CHANGED"===t){var l=a.author_id;if(c.has(l)){var u=c.get(l);for(var m in a.values)u[m]=a.values[m]}}else"CLEAR_MESSAGES"===t?g(function(e){return E.clear(),[]}):"HELLO"===t||console.error("Unknown message type '"+t+"', protocol message = '"+e+"'")}},[W,g]);var F=(e={},Object(i.a)(e,u.ReadyState.CONNECTING,"Connecting..."),Object(i.a)(e,u.ReadyState.OPEN,"Open"),Object(i.a)(e,u.ReadyState.CLOSING,"Closing"),Object(i.a)(e,u.ReadyState.CLOSED,"Closed. Please launch the AxelChat or restart the widget..."),Object(i.a)(e,u.ReadyState.UNINSTANTIATED,"Uninstantiated"),e)[z];if(z===u.ReadyState.OPEN){var K=a.get("widget");return"messages"===K?r.a.createElement(C,{messages:v,hideTimeout:0}):"selected-messages"===K?r.a.createElement(C,{messages:w,hideTimeout:0}):"states"===K?r.a.createElement(T,{services:R,appState:G}):r.a.createElement("span",{className:"errorText"},"Error: unknown widget")}return r.a.createElement(j,{type:z===u.ReadyState.CONNECTING?O:y,text:F,imageSrc:"./images/error-alt-svgrepo-com.svg"})};c.a.createRoot(document.getElementById("root")).render(r.a.createElement(p.a,null,r.a.createElement(x,null)))}},[[68,2,1]]]);
//# sourceMappingURL=main.75c84d1a.chunk.js.map